<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VillePropre - Optimisation des Tourn√©es de Collecte</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/niveau3.css">
    <link rel="stylesheet" href="css/timeline.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>üöõ VillePropre</h1>
            <p class="subtitle">Optimisation des Tourn√©es de Collecte de D√©chets</p>
        </header>

        <!-- Panneau de contr√¥le -->
        <div class="control-panel">
            <div class="panel-section">
                <h2>üìç Points de Collecte</h2>
                <button id="btn-add-point" class="btn btn-primary">Ajouter un Point</button>
                <button id="btn-clear-points" class="btn btn-secondary">Effacer Tout</button>
                <div id="points-list" class="points-list"></div>
            </div>

            <div class="panel-section">
                <h2>üöõ Camions</h2>
                <button id="btn-add-camion" class="btn btn-primary">Ajouter un Camion</button>
                <div id="camions-list" class="camions-list"></div>
            </div>

            <div class="panel-section">
                <h2>üè≠ D√©chetteries</h2>
                <button id="btn-add-dechetterie" class="btn btn-primary">Ajouter une D√©chetterie</button>
                <small style="display: block; margin-top: 5px; color: #666;">Centres de traitement o√π les camions d√©posent les d√©chets collect√©s</small>
                <div id="dechetteries-list" class="dechetteries-list"></div>
            </div>

            <div class="panel-section">
                <h2>üè≠ D√©p√¥t</h2>
                <button id="btn-select-depot" class="btn btn-info">Choisir le D√©p√¥t</button>
                <small style="display: block; margin-top: 5px; color: #666;">Glisser le marqueur rouge ou cliquer sur "Choisir" puis sur la carte</small>
            </div>

            <div class="panel-section" id="niveau3-config-accordion">
                <h2>‚è∞ Configuration Temporelle</h2>
                <div class="niveau3-tabs">
                    <button type="button" class="niveau3-tab active" id="niveau3-tab-creneaux">Cr√©neaux Horaires</button>
                    <button type="button" class="niveau3-tab" id="niveau3-tab-contraintes">Contraintes</button>
                </div>
                <div id="niveau3-panel-creneaux" class="niveau3-panel active">
                    <button type="button" id="btn-add-creneau" class="btn btn-primary">+ Ajouter un Cr√©neau</button>
                    <button type="button" id="btn-dupliquer-semaine" class="btn btn-secondary">Dupliquer cette semaine</button>
                    <div style="margin-top:8px;">
                        <span>Charger template :</span>
                        <button type="button" id="template-classique" class="btn btn-secondary" style="margin:0 4px;">Semaine classique</button>
                        <button type="button" id="template-mediterranee" class="btn btn-secondary" style="margin:0 4px;">M√©diterran√©e</button>
                        <button type="button" id="template-ramadan" class="btn btn-secondary" style="margin:0 4px;">Ramadan</button>
                    </div>
                    <div id="creneaux-grid-container" style="margin-top:12px;"></div>
                </div>
                <div id="niveau3-panel-contraintes" class="niveau3-panel">
                    <div class="contraintes-tabs">
                        <button type="button" class="contraintes-sub-tab active" data-target="contraintes-fenetres">Fen√™tres Zones</button>
                        <button type="button" class="contraintes-sub-tab" data-target="contraintes-pauses">Pauses Camions</button>
                        <button type="button" class="contraintes-sub-tab" data-target="contraintes-interdites">Interdictions</button>
                    </div>
                    <div id="contraintes-fenetres" class="contraintes-sub-panel active">
                        <div id="contraintes-fenetres-container"></div>
                    </div>
                    <div id="contraintes-pauses" class="contraintes-sub-panel">
                        <div id="contraintes-pauses-container"></div>
                    </div>
                    <div id="contraintes-interdites" class="contraintes-sub-panel">
                        <div id="contraintes-interdites-container"></div>
                    </div>
                </div>
            </div>

            <div class="panel-section">
                <h2>‚öôÔ∏è Optimisation</h2>
                <button id="btn-niveau1" class="btn btn-success">Niveau 1 : Calculer Distances</button>
                <button id="btn-niveau2" class="btn btn-success">Niveau 2 : Affecter Zones</button>
                <div style="margin:10px 0;">
                    <button id="btn-niveau3" class="btn btn-niveau3">üÜï Niveau 3 : G√©n√©rer Planning</button>
                    <small style="display:block;margin-top:5px;color:#666;">Planification hebdomadaire</small>
                </div>
                <label style="display: flex; align-items: center; gap: 8px; margin: 8px 0;">
                    <input type="checkbox" id="niveau3-use-contraintes" checked>
                    <span>Inclure contraintes temporelles</span>
                </label>
                <label style="display: flex; align-items: center; gap: 8px; margin: 8px 0;">
                    <span>Horizon :</span>
                    <input type="number" id="niveau3-horizon" value="7" min="1" max="7" style="width:60px;"> jours
                </label>
                <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px; cursor: pointer;">
                    <input type="checkbox" id="use-osrm-routes">
                    <span>üó∫Ô∏è Utiliser OSRM (distances routi√®res r√©elles)</span>
                </label>
                <button id="btn-routes-optimisees" class="btn btn-success" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">üöÄ Routes Optimis√©es avec D√©chetteries</button>
                <small style="display: block; margin-top: 5px; color: #666;">
                    Calcule les routes intelligentes : D√©p√¥t ‚Üí Collecte ‚Üí D√©chetterie ‚Üí Collecte ‚Üí ... ‚Üí D√©p√¥t
                </small>
                <button id="btn-animate-routes" class="btn btn-info" style="display: none; background: linear-gradient(135deg, #00b894, #00cec9);">
                    üé¨ Animation des Routes
                </button>
                <button id="btn-simuler" class="btn btn-warning" disabled>‚ñ∂Ô∏è Simuler</button>
                <button id="btn-stop-sim" class="btn btn-danger" style="display: none;">‚èπÔ∏è Arr√™ter</button>
                <button id="btn-show-presentation" class="btn btn-info" style="display: none;">üìä Afficher Pr√©sentation</button>
            </div>

            <div class="panel-section">
                <h2>üíæ Templates</h2>
                <button id="btn-export-template" class="btn btn-primary">üì§ Exporter Template</button>
                <button id="btn-import-template" class="btn btn-secondary">üì• Importer Template</button>
                <small style="display: block; margin-top: 5px; color: #666;">
                    Exporte/Importe tous les √©l√©ments et r√©sultats (points, camions, d√©chetteries, routes OSRM)
                </small>
            </div>
        </div>

        <!-- Carte et Panneau de pr√©sentation -->
        <div class="map-presentation-container">
            <!-- Carte -->
            <div class="map-container">
                <div id="map">
                    <div style="padding: 20px; text-align: center; color: #666;">
                        Chargement de la carte...
                    </div>
                </div>
            </div>
            
            <!-- Panneau de pr√©sentation visuelle -->
            <div id="presentation-panel" class="presentation-panel" style="display: none;">
                <div class="presentation-header">
                    <h3>üìä Pr√©sentation Visuelle</h3>
                    <button id="btn-close-presentation" class="btn-close-presentation">&times;</button>
                </div>
                <div id="presentation-content" class="presentation-content">
                    <!-- Le contenu sera g√©n√©r√© dynamiquement -->
                </div>
            </div>
        </div>

        <!-- Dashboard -->
        <div class="dashboard" id="dashboard" style="display: none;">
            <h2>üìä Statistiques</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Distance Totale</div>
                    <div class="stat-value" id="stat-distance">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Co√ªt Total</div>
                    <div class="stat-value" id="stat-cout">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Camions Utilis√©s</div>
                    <div class="stat-value" id="stat-camions">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Taux Utilisation</div>
                    <div class="stat-value" id="stat-taux">-</div>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="chart-charges"></canvas>
            </div>
        </div>
    </div>

    <!-- Article Explicatif -->
    <article class="explanatory-article">
        <div class="article-container">
            <h2>üìñ Comment Fonctionne Notre Syst√®me d'Optimisation ?</h2>
            
            <section class="article-section">
                <h3>üéØ Vue d'Ensemble</h3>
                <p>
                    <strong>VillePropre</strong> est un syst√®me intelligent qui aide √† organiser la collecte des d√©chets 
                    dans une ville. Imaginez que vous devez envoyer plusieurs camions pour ramasser les d√©chets √† diff√©rents 
                    endroits. Notre syst√®me calcule automatiquement les meilleurs chemins et d√©cide quel camion doit aller o√π, 
                    tout en respectant les contraintes importantes comme la capacit√© des camions.
                </p>
            </section>

            <section class="article-section">
                <h3>üìç √âtape 1 : Ajouter les Points de Collecte</h3>
                <p>
                    La premi√®re √©tape consiste √† placer sur la carte tous les endroits o√π il faut collecter les d√©chets. 
                    Pour chaque point, vous indiquez :
                </p>
                <ul>
                    <li><strong>Le nom</strong> : pour identifier facilement l'endroit (ex: "Quartier Nord", "Centre-ville")</li>
                    <li><strong>Le volume estim√©</strong> : combien de kilos de d√©chets il y a √† collecter</li>
                    <li><strong>La priorit√©</strong> : certains endroits sont plus urgents que d'autres</li>
                </ul>
                <p>
                    Ces points apparaissent sur la carte avec des cercles bleus üóëÔ∏è. Vous pouvez en ajouter autant que n√©cessaire 
                    en cliquant sur "Ajouter un Point" puis sur la carte.
                </p>
            </section>

            <section class="article-section">
                <h3>üè≠ √âtape 2 : Choisir le D√©p√¥t</h3>
                <p>
                    Le d√©p√¥t est l'endroit o√π tous les camions commencent et finissent leur tourn√©e. C'est comme le "garage" 
                    des camions. Vous devez s√©lectionner un des points de collecte existants pour en faire le d√©p√¥t. 
                    Ce point devient rouge üè≠ et sert de point de d√©part et d'arriv√©e pour tous les camions.
                </p>
                <p>
                    <strong>Pourquoi c'est important ?</strong> Tous les chemins sont calcul√©s depuis et vers ce d√©p√¥t, 
                    ce qui garantit que chaque camion peut revenir d√©charger les d√©chets collect√©s.
                </p>
            </section>

            <section class="article-section">
                <h3>üöõ √âtape 3 : Ajouter les Camions</h3>
                <p>
                    Ensuite, vous ajoutez les camions disponibles. Pour chaque camion, vous pr√©cisez :
                </p>
                <ul>
                    <li><strong>La capacit√©</strong> : combien de kilos le camion peut transporter (ex: 5000 kg)</li>
                    <li><strong>Le co√ªt fixe</strong> : ce que co√ªte l‚Äôutilisation de ce camion (ex: 200 ‚Ç¨). Ce n‚Äôest <em>pas</em> le co√ªt total : le syst√®me calcule le co√ªt total en ajoutant carburant (distance), manutention (volume) et ce co√ªt fixe.</li>
                    <li><strong>Les zones accessibles</strong> : <em>Optionnel</em> - quels points de collecte ce camion peut atteindre</li>
                </ul>
                <p>
                    <strong>Zones accessibles :</strong> C'est un champ <em>optionnel</em> qui permet de limiter o√π chaque camion peut aller. 
                    Par exemple :
                </p>
                <ul>
                    <li>Un petit camion peut √™tre limit√© aux zones r√©sidentielles (ex: zones 1, 2, 3)</li>
                    <li>Un gros camion peut acc√©der √† toutes les zones (laissez le champ vide)</li>
                    <li>Un camion sp√©cialis√© peut √™tre limit√© √† certaines zones industrielles</li>
                </ul>
                <p>
                    <strong>Important :</strong> Si vous laissez le champ "Zones accessibles" vide, le camion pourra acc√©der √† 
                    <strong>toutes les zones</strong> (camion universel). C'est utile pour les camions polyvalents.
                </p>
            </section>

            <section class="article-section">
                <h3>üó∫Ô∏è √âtape 4 : Calculer les Chemins Optimaux (Niveau 1)</h3>
                <p>
                    Quand vous cliquez sur "Niveau 1 : Calculer Distances", le syst√®me utilise un algorithme appel√© 
                    <strong>Dijkstra</strong> pour trouver les chemins les plus courts entre <strong>tous les points</strong>.
                </p>
                <p>
                    <strong>Comment √ßa marche ?</strong>
                </p>
                <ul>
                    <li>Le syst√®me imagine que tous les points sont reli√©s par des routes</li>
                    <li>Il calcule la distance la plus courte entre <strong>chaque paire de points</strong> (pas seulement depuis le d√©p√¥t)</li>
                    <li>Cela permet aux camions d'aller directement d'un point de collecte √† un autre sans forc√©ment retourner au d√©p√¥t</li>
                    <li>Ces chemins peuvent passer par plusieurs points interm√©diaires pour √™tre vraiment optimaux</li>
                </ul>
                <p>
                    <strong>Exemple concret :</strong> Si un camion doit collecter le Point A puis le Point B, le syst√®me calcule 
                    le chemin le plus court directement de A vers B. Le camion n'a pas besoin de retourner au d√©p√¥t entre chaque collecte, 
                    ce qui √©conomise du temps et du carburant !
                </p>
                <p>
                    Sur la carte, vous verrez des lignes bleues qui montrent ces chemins calcul√©s. Ces chemins sont 
                    <strong>les plus courts possibles</strong>, ce qui signifie moins de temps de trajet et moins de carburant utilis√©.
                </p>
            </section>

            <section class="article-section">
                <h3>‚öñÔ∏è √âtape 5 : Affecter les Zones aux Camions (Niveau 2)</h3>
                <p>
                    Le "Niveau 2" utilise un algorithme <strong>glouton</strong> pour d√©cider quel camion doit collecter quels points. 
                    C'est comme r√©soudre un puzzle : on essaie de remplir chaque camion de mani√®re optimale.
                </p>
                <p>
                    <strong>Le processus :</strong>
                </p>
                <ol>
                    <li>Le syst√®me regarde tous les points de collecte qui ne sont pas encore assign√©s</li>
                    <li>Pour chaque camion disponible, il calcule le "co√ªt" d'ajouter chaque point</li>
                    <li>Il choisit la combinaison camion-point qui donne le meilleur rapport qualit√©/prix</li>
                    <li>Il r√©p√®te ce processus jusqu'√† ce que tous les points soient assign√©s</li>
                </ol>
                <p>
                    <strong>Exemple concret :</strong> Si le Camion 1 peut prendre 3 points et le Camion 2 peut prendre 2 points, 
                    le syst√®me essaie diff√©rentes combinaisons pour trouver celle qui minimise le co√ªt total tout en utilisant 
                    au mieux la capacit√© de chaque camion.
                </p>
            </section>

            <section class="article-section">
                <h3>üõ°Ô∏è Gestion des Contraintes</h3>
                <p>
                    Le syst√®me respecte automatiquement plusieurs r√®gles importantes. Si une contrainte n'est pas respect√©e, 
                    vous recevrez un avertissement avec les d√©tails du probl√®me :
                </p>
                <div class="constraints-grid">
                    <div class="constraint-card">
                        <h4>üì¶ Contrainte de Capacit√©</h4>
                        <p>
                            Un camion ne peut jamais transporter plus que sa capacit√© maximale. Si un camion peut transporter 
                            5000 kg, il ne collectera que des points dont le volume total ne d√©passe pas 5000 kg.
                            <br><strong>V√©rification automatique :</strong> Le syst√®me v√©rifie cette contrainte apr√®s chaque affectation.
                        </p>
                    </div>
                    <div class="constraint-card">
                        <h4>üöß Contrainte d'Accessibilit√©</h4>
                        <p>
                            Chaque camion ne peut aller que dans les zones qui lui sont accessibles. Si vous avez sp√©cifi√© 
                            que le Camion 1 peut acc√©der aux zones 1, 2 et 3, il ne pourra jamais √™tre assign√© √† la zone 4.
                            <br><strong>Note :</strong> Si vous laissez le champ vide, le camion peut acc√©der √† toutes les zones.
                        </p>
                    </div>
                    <div class="constraint-card">
                        <h4>üè≠ Contrainte du D√©p√¥t Unique</h4>
                        <p>
                            Tous les camions doivent commencer et finir au m√™me d√©p√¥t. Cela garantit une organisation 
                            coh√©rente et facilite la gestion des v√©hicules. Le syst√®me v√©rifie automatiquement que tous 
                            les trajets commencent et se terminent au d√©p√¥t s√©lectionn√©.
                        </p>
                    </div>
                    <div class="constraint-card">
                        <h4>‚öñÔ∏è √âquilibrage de Charge</h4>
                        <p>
                            Le syst√®me essaie de r√©partir √©quitablement le travail entre les camions. Il √©vite qu'un camion 
                            soit surcharg√© pendant qu'un autre est presque vide. Cette optimisation am√©liore l'efficacit√© 
                            globale du syst√®me.
                        </p>
                    </div>
                </div>
                <p style="margin-top: 20px; padding: 15px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 5px;">
                    <strong>üí° Astuce :</strong> Apr√®s le Niveau 2, si vous voyez des avertissements, v√©rifiez les zones accessibles 
                    de vos camions et leurs capacit√©s. Le syst√®me vous indiquera exactement quelles contraintes ne sont pas respect√©es.
                </p>
            </section>

            <section class="article-section">
                <h3>üé¨ √âtape 6 : Visualiser la Simulation</h3>
                <p>
                    Une fois l'affectation termin√©e, vous pouvez lancer la simulation pour voir comment les camions se d√©placent 
                    en temps r√©el. Sur la carte, vous verrez :
                </p>
                <ul>
                    <li>Les camions üöõ qui se d√©placent le long des chemins calcul√©s</li>
                    <li>Les points qui changent de couleur : bleu (en attente) ‚Üí jaune (en cours) ‚Üí vert (collect√©)</li>
                    <li>La charge de chaque camion qui augmente au fur et √† mesure de la collecte</li>
                </ul>
                <p>
                    Dans le panneau de pr√©sentation √† droite, vous avez une vue sch√©matique avec :
                </p>
                <ul>
                    <li>Des lignes horizontales repr√©sentant les chemins de chaque camion</li>
                    <li>Le d√©p√¥t üè≠ √† gauche et les points de collecte üóëÔ∏è √† droite</li>
                    <li>Les camions qui se d√©placent visuellement de gauche √† droite</li>
                    <li>Les r√©sultats d√©taill√©s de l'algorithme (distance, co√ªt, utilisation, etc.)</li>
                </ul>
            </section>

            <section class="article-section">
                <h3>üìä Comprendre les R√©sultats</h3>
                <p>
                    Apr√®s l'optimisation, le syst√®me vous montre plusieurs statistiques importantes :
                </p>
                <ul>
                    <li><strong>Distance Totale</strong> : La somme de tous les trajets effectu√©s par tous les camions</li>
                    <li><strong>Co√ªt total</strong> : calcul√© par le syst√®me pour toutes les tourn√©es (distance √ó carburant + volume √ó manutention + co√ªt fixe de chaque camion utilis√©). Ce n‚Äôest pas uniquement la somme des co√ªts fixes.</li>
                    <li><strong>Camions Utilis√©s</strong> : Combien de camions ont √©t√© n√©cessaires sur le total disponible</li>
                    <li><strong>Taux d'Utilisation</strong> : √Ä quel pourcentage chaque camion a √©t√© utilis√© (id√©alement proche de 100%)</li>
                    <li><strong>√âquilibrage de Charge</strong> : Une mesure de la r√©partition √©quitable du travail</li>
                </ul>
                <p>
                    <strong>Objectif :</strong> Minimiser le co√ªt total tout en utilisant efficacement les camions disponibles 
                    et en respectant toutes les contraintes.
                </p>
            </section>

            <section class="article-section">
                <h3>üí° Pourquoi C'est Efficace ?</h3>
                <p>
                    Sans ce syst√®me, organiser manuellement les tourn√©es serait tr√®s difficile et prendrait beaucoup de temps. 
                    Il faudrait :
                </p>
                <ul>
                    <li>Calculer toutes les distances possibles entre les points</li>
                    <li>Essayer toutes les combinaisons possibles d'affectation</li>
                    <li>V√©rifier manuellement que toutes les contraintes sont respect√©es</li>
                    <li>Comparer des centaines de solutions pour trouver la meilleure</li>
                </ul>
                <p>
                    Notre syst√®me fait tout cela automatiquement en quelques secondes, en utilisant des algorithmes math√©matiques 
                    √©prouv√©s qui garantissent une solution optimale ou tr√®s proche de l'optimum.
                </p>
            </section>

            <section class="article-section highlight-box">
                <h3>‚ú® En R√©sum√©</h3>
                <p>
                    <strong>VillePropre</strong> transforme un probl√®me complexe d'organisation en un processus simple et visuel :
                </p>
                <ol>
                    <li>Vous placez les points de collecte sur la carte</li>
                    <li>Vous choisissez le d√©p√¥t et ajoutez les camions</li>
                    <li>Le syst√®me calcule automatiquement les meilleurs chemins</li>
                    <li>Le syst√®me assigne intelligemment les points aux camions</li>
                    <li>Vous visualisez le r√©sultat avec une simulation anim√©e</li>
                </ol>
                <p>
                    Le tout en respectant les capacit√©s des camions, leurs limitations d'acc√®s, et en minimisant les co√ªts !
                </p>
            </section>
        </div>
    </article>

    <!-- Loader Niveau 3 -->
    <div id="niveau3-loader" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:9999;align-items:center;justify-content:center;flex-direction:column;">
        <div style="background:white;padding:30px;border-radius:12px;text-align:center;">
            <div style="font-size:48px;">üîÑ</div>
            <div style="font-weight:bold;">G√©n√©ration du planning hebdomadaire...</div>
            <div style="color:#666;">Analyse des contraintes temporelles...</div>
        </div>
    </div>

    <!-- Modal Cr√©neau -->
    <div id="modal-creneau" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('modal-creneau').style.display='none'">&times;</span>
            <h2 id="creneau-form-title">Ajouter un cr√©neau</h2>
            <form id="creneau-form">
                <label>Jour</label>
                <select id="creneau-jour">
                    <option value="lundi">Lundi</option>
                    <option value="mardi">Mardi</option>
                    <option value="mercredi">Mercredi</option>
                    <option value="jeudi">Jeudi</option>
                    <option value="vendredi">Vendredi</option>
                    <option value="samedi">Samedi</option>
                    <option value="dimanche">Dimanche</option>
                </select>
                <label>Heure d√©but</label>
                <input type="time" id="creneau-debut" value="08:00">
                <label>Heure fin</label>
                <input type="time" id="creneau-fin" value="10:00">
                <label>Congestion</label>
                <div class="congestion-slider">
                    <input type="range" id="creneau-congestion" min="1" max="2" step="0.1" value="1">
                    <div id="creneau-congestion-label" class="congestion-label">Trafic : Normal</div>
                </div>
                <button type="submit" class="btn btn-primary">Sauvegarder</button>
            </form>
        </div>
    </div>

    <!-- Modal Planning -->
    <div id="planning-modal" class="planning-modal">
        <div class="planning-modal-content">
            <div class="planning-modal-header">
                <h2>üìÖ Planning Hebdomadaire</h2>
                <button type="button" id="planning-modal-close" class="planning-modal-close" aria-label="Fermer">&times;</button>
            </div>
            <div class="planning-views-tabs">
                <button type="button" class="planning-view-tab active" id="planning-tab-timeline">üìÖ Timeline</button>
                <button type="button" class="planning-view-tab" id="planning-tab-carte">üó∫Ô∏è Carte Anim√©e</button>
                <button type="button" class="planning-view-tab" id="planning-tab-stats">üìä Statistiques</button>
            </div>
            <div id="planning-panel-timeline" class="planning-view-panel active">
                <div id="timeline-content" class="timeline-container"></div>
            </div>
            <div id="planning-panel-carte" class="planning-view-panel">
                <p style="padding:20px;color:#666;">Carte anim√©e - Simulation des camions (√† venir)</p>
            </div>
            <div id="planning-panel-stats" class="planning-view-panel">
                <div id="stats-dashboard-content"></div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="modal-point" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Ajouter un Point de Collecte</h2>
            <form id="form-point">
                <label>Nom:</label>
                <input type="text" id="point-nom" placeholder="Ex: Quartier Nord" required>
                <label>Volume estim√© (kg):</label>
                <input type="number" id="point-volume" placeholder="1200" min="0" required>
                <label>Priorit√©:</label>
                <select id="point-priorite">
                    <option value="normale">Normale</option>
                    <option value="haute">Haute</option>
                    <option value="basse">Basse</option>
                </select>
                <button type="submit" class="btn btn-primary">Ajouter</button>
            </form>
        </div>
    </div>

    <div id="modal-camion" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Ajouter un Camion</h2>
            <form id="form-camion">
                <label>ID Camion:</label>
                <input type="number" id="camion-id" placeholder="1" min="1" required>
                <label>Capacit√© (kg):</label>
                <input type="number" id="camion-capacite" placeholder="5000" min="0" required>
                <label>Co√ªt fixe (‚Ç¨):</label>
                <input type="number" id="camion-cout" placeholder="200" min="0" step="0.01" required>
                <small style="display: block; margin-top: 2px; margin-bottom: 10px; color: #666;">
                    <strong>Ce n‚Äôest pas le co√ªt total.</strong> C‚Äôest le co√ªt d‚Äôutilisation de ce camion (ex: 200 ‚Ç¨ par tourn√©e). 
                    Le <em>co√ªt total</em> est calcul√© par le syst√®me : il ajoute pour chaque zone (carburant, manutention) + ce co√ªt fixe.
                </small>
                <label>Zones accessibles (IDs s√©par√©s par virgule) - <em>Optionnel</em>:</label>
                <input type="text" id="camion-zones" placeholder="1,2,3 (ou laissez vide pour toutes)">
                <small style="display: block; margin-top: 5px; color: #666;">
                    <strong>Optionnel :</strong> Entrez les IDs des points de collecte que ce camion peut atteindre (ex: 1,2,3). 
                    <br><strong>Laissez vide</strong> pour permettre l'acc√®s √† toutes les zones (camion universel).
                    <br><em>Exemple : Un petit camion peut √™tre limit√© aux zones 1,2,3, tandis qu'un gros camion peut acc√©der √† toutes.</em>
                </small>
                <button type="submit" class="btn btn-primary">Ajouter</button>
            </form>
        </div>
    </div>

    <div id="modal-dechetterie" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Ajouter une D√©chetterie</h2>
            <p style="margin-bottom: 15px; color: #666; font-size: 14px;">
                <strong>D√©chetterie :</strong> Centre de traitement o√π les camions d√©posent les d√©chets collect√©s depuis les points de collecte.
                <br>Le syst√®me choisira automatiquement la d√©chetterie la plus proche pour chaque camion.
            </p>
            <form id="form-dechetterie">
                <label>ID D√©chetterie:</label>
                <input type="number" id="dechetterie-id" placeholder="11" min="1" required>
                <label>Nom:</label>
                <input type="text" id="dechetterie-nom" placeholder="Ex: D√©chetterie Nord" required>
                <label>Capacit√© maximale (kg) - <em>Optionnel</em>:</label>
                <input type="number" id="dechetterie-capacite" placeholder="10000 (0 = illimit√©e)" min="0" value="0">
                <small style="display: block; margin-top: 2px; margin-bottom: 10px; color: #666;">
                    Capacit√© maximale de stockage. Laissez 0 pour une capacit√© illimit√©e.
                </small>
                <label>Types de d√©chets accept√©s - <em>Optionnel</em>:</label>
                <input type="text" id="dechetterie-types" placeholder="verre, papier, plastique, m√©tal">
                <small style="display: block; margin-top: 2px; margin-bottom: 10px; color: #666;">
                    S√©parez les types par des virgules (ex: verre, papier, plastique)
                </small>
                <button type="submit" class="btn btn-primary">Ajouter</button>
            </form>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Scripts -->
    <script src="js/template.js"></script>
    <script src="js/map.js"></script>
    <script src="js/timeline-view.js"></script>
    <script src="js/stats-dashboard.js"></script>
    <script src="js/niveau3.js"></script>
    <script src="js/simulation.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/presentation.js"></script>
    <script src="js/route_animation.js"></script>
</body>
</html>
